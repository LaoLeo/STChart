{"version":3,"file":"STChart.js","sources":["../src/util.js","../src/main.js"],"sourcesContent":["const NODE_TYPE_TEXT = {\n    1: '开始',\n    2: '剧情',\n    3: '结局',\n};\n\n/*\n        id: dialog.dialogId,\n        description: dialog.description,\n        name: dialog.name,\n        chapter: dialog.chapter,\n        index: treeNode ? treeNode.index : dialog.dialogId,\n        deepLevel: treeNode ? treeNode.deepLevel : 0, // 在composeProcessDialogs中会用到\n        position: posMap[dialog.dialogId],\n        isChapFirstNode,\n        nodeType: NODE_TYPE_TEXT[dialog.type],\n        type: dialog.type,\n        children: []\n*/\n\nexport function filterDialogsByChapter(chapter, processDialogs) {\n    let dialogs, dialogsInNextChap;\n    if (chapter) {\n        dialogs = processDialogs.filter(\n            d => d.chapter === chapter\n        );\n        // 衔接点\n        dialogsInNextChap = getDialogsOfNextChapter(\n            dialogs,\n            processDialogs\n        );\n    } else {\n        dialogs = processDialogs\n        dialogsInNextChap = []\n    }\n\n    let f_data = formatData(\n        chapter,\n        [...dialogs, ...dialogsInNextChap],\n        processDialogs\n    );\n\n\n    return {\n        datas: f_data.dioDatas.nodes,\n        links: f_data.dioDatas.links\n    };\n}\n\n\nfunction formatData(chapter, dioDatas, processDialogs) {\n    // 格式化 后台传入的数据\n\n    let links = [];\n    let nodes = [];\n\n    // 如果没有内容，初始化数据\n    if (dioDatas.length === 0) {\n        dioDatas = _genDefaultData(chapter);\n        // processDialogs为空时，会影响positionMap的生成\n        if (processDialogs.length === 0) processDialogs = dioDatas;\n    }\n\n    let posMap = genDialogPosition(chapter, dioDatas, processDialogs);\n\n    let dialogTreeDatas = genDialogTree(processDialogs);\n\n    dioDatas.forEach((value) => {\n        // 格式化树\n        if (value.children) {\n            let temp = _genLinks(value, dioDatas);\n            links = [...links, ...temp];\n        }\n\n        let node = _genNodes(value, posMap, dialogTreeDatas);\n        nodes.push(node);\n    });\n\n    return {\n        'dioDatas': {\n            'nodes': nodes,\n            'links': links\n        }\n    };\n}\n\nfunction _genLinks(value, dioDatas) {\n    let links = [];\n\n    value.children.forEach((nextDialogId) => {\n        // 检验完整\n        let index = -1;\n        index = dioDatas.findIndex(function (item) {\n            return item.dialogId == nextDialogId;\n        });\n\n        if (index >= 0) {\n            // 选项->下一节点\n            links.push({\n                id: value.dialogId + '-' + nextDialogId,\n                name: `${value.name} -> ${dioDatas[index].name}`,\n                source: value.dialogId,\n                target: nextDialogId\n            });\n        }\n    });\n\n    return links;\n}\n\nfunction _genNodes(dialog, posMap, dialogTreeDatas) {\n\n    let treeNode = dialogTreeDatas.find(n => n.id === dialog.dialogId);\n    let isChapFirstNode = false;\n    if (treeNode) {\n        // 挂上深度deepLevel，在moveDialogs中会作为判断条件\n        dialog.deepLevel = treeNode.deepLevel;\n        isChapFirstNode = treeNode.parents.some(d => d.chapter !== dialog.chapter);\n    }\n\n    let node = {\n        id: dialog.dialogId,\n        description: dialog.description,\n        name: dialog.name,\n        chapter: dialog.chapter,\n        index: treeNode ? treeNode.index : dialog.dialogId,\n        deepLevel: treeNode ? treeNode.deepLevel : 0, // 在composeProcessDialogs中会用到\n        position: posMap[dialog.dialogId],\n        isChapFirstNode,\n        nodeType: NODE_TYPE_TEXT[dialog.type],\n        type: dialog.type,\n        children: dialog.children\n    };\n\n    return node;\n}\n\nfunction _genDefaultData(chapter) {\n    let dioDatas = [];\n\n    if (chapter === 1) {\n        let startId = genRandomId();\n        let nextId = genRandomId();\n\n        dioDatas = [{\n            dialogId: `d_${startId}`,\n            description: '这是一个故事的开头，播完会进入第一个剧情',\n            name: '开头',\n            type: 1,\n            nodeType: NODE_TYPE_TEXT[1],\n            chapter: 1,\n            deepLevel: 0,\n            children: [`d_${nextId}`]\n        },\n        {\n            dialogId: `d_${nextId}`,\n            description: '这是故事的第一个剧情，完成后用户可以开始进行选择。这也是一个存档点，用户再次进入游戏时会跳过开头从这里开始',\n            name: '1-1:剧情',\n            type: 2,\n            nodeType: NODE_TYPE_TEXT[2],\n            chapter: 1,\n            deepLevel: 1\n        }];\n    }\n\n    return dioDatas;\n}\n\n\n\n\nfunction genDialogPosition(currChapNo, dialogs, processDialogs) {\n    let roots = findRoots(currChapNo, processDialogs);\n    let posMap = {};\n    roots.forEach(root => {\n        let position = 0;\n        _genPos(root, position, dialogs);\n    });\n\n    function _genPos(node, position, dialogs) {\n        posMap[node.dialogId] = position;\n\n        let nextIds = getNextDialogIds(node);\n        nextIds.forEach(id => {\n            let child = dialogs.find(d => d.dialogId === id);\n            if (child) {\n                if (posMap[child.dialogId] === undefined) {\n                    _genPos(child, position + 1, dialogs);\n                }\n            }\n        });\n    }\n\n    return posMap;\n}\n\n// 找出不作为子节点的节点作为首节点\n// 问题: 章节第一个节点成环会出问题，找不出第一个节点\nfunction _findRoots$1(dioDatas) {\n    let nextIds = [];\n    dioDatas.filter(d => !!d.children)\n        .forEach(d => {\n            nextIds = [...nextIds, ...d.children]\n        })\n\n    return dioDatas.filter(d => !nextIds.includes(d.dialogId));\n}\n\n// 父节点位于其他章节的节点作为首节点\nfunction _findRoots$2(currChapNo, processDialogs) {\n    let roots = [];\n    processDialogs.forEach(d => {\n        if (d.chapter === currChapNo) return;\n\n        let nextIds = getNextDialogIds(d);\n        let nextDialog = nextIds.map(id => processDialogs.find(d => d.dialogId === id));\n        nextDialog.forEach(d => {\n            if (d.chapter === currChapNo) roots.push(d);\n        });\n    });\n\n    return roots;\n}\n\n// 选出章节或剧情的根节点，可能有多个\nfunction findRoots(currChapNo, processDialogs) {\n    if (typeof processDialogs === 'undefined') {\n        processDialogs = currChapNo;\n        return _findRoots$1(processDialogs);\n    }\n\n    // 章节内不是子节点的节点为首节点\n    let currChapDialog\n    if (currChapNo) {\n        currChapDialog = processDialogs.filter(d => (d.chapter === currChapNo));\n    } else {\n        currChapDialog = processDialogs\n    }\n    let roots$1 = _findRoots$1(currChapDialog);\n\n    // 跳章节点为首节点\n    let roots$2 = _findRoots$2(currChapNo, processDialogs);\n\n    let roots = [...new Set(roots$1.concat(roots$2))];\n\n    if (roots.length === 0 && currChapDialog.length !== 0) {\n        // 章内节点与首节点成环，且首节点不被其他章节链接\n        // 这种情况非常特殊，选取该章节节点数组第一个作为首节点\n        roots.push(currChapDialog[0]);\n    }\n\n    return roots;\n}\n\n// 生成剧情衔接点\nfunction getDialogsOfNextChapter(dialogs, processDialogs) {\n    const idInCurrChap = dialogs.map(d => d.dialogId);\n    let result = [];\n\n    dialogs.forEach(d => {\n        let nextIds = getNextDialogIds(d);\n        let ids = nextIds.filter(id => !idInCurrChap.includes(id));\n        let dialogs = ids.map(id => processDialogs.find(d => d.dialogId === id));\n        result = [...result, ...dialogs];\n    });\n\n    return [...(new Set(result))].filter(d => !!d);\n}\n\n// 生成剧情节点树节点数组\nfunction genDialogTree(processDialogs) {\n    let roots = findRoots(processDialogs);\n    // let root = processDialogs.find(d => d.type === 1)\n    let nodes = [];\n\n    roots.forEach(root => {\n        root && _gen(root, null, null, 0, processDialogs, nodes);\n    });\n\n    function _gen(dialog, parent, preNode, deepLevel, processDialogs, nodes) {\n        let handledNode = nodes.find(n => n.id === dialog.dialogId);\n\n        if (!handledNode) {\n            let node = {\n                id: dialog.dialogId,\n                children: [],\n                parents: parent ? [parent] : [],\n                deepLevel,\n                index: preNode ? `${preNode.index}->${dialog.dialogId}` : dialog.dialogId\n            };\n            nodes.push(node);\n\n            let nextIds = getNextDialogIds(dialog);\n            deepLevel++;\n            nextIds.forEach(id => {\n                let child = processDialogs.find(d => d.dialogId === id);\n                if (child) {\n                    // 避免子节点不在剧情树中的情况，一般这种情况是同步数据有误\n                    node.children.push(child);\n\n                    _gen(child, dialog, node, deepLevel, processDialogs, nodes);\n                }\n            });\n            // nodes.push(node)\n\n\n        } else {\n            let isExist = parent && handledNode.parents.find(p => p.id === parent.dialogId);\n            if (!isExist) handledNode.parents.push(parent);\n        }\n    }\n\n    // 检测有没有处理了所有的剧情点\n    // 当全部剧情点中成环的剧情点是没有处理的，因为findRoots函数没办法判断出来\n    if (nodes.length !== processDialogs.length) {\n        let dialogsOnCricle = processDialogs.filter(d => !nodes.find(n => n.id === d.dialogId));\n        dialogsOnCricle.forEach(d => {\n            _gen(d, null, null, 0, processDialogs, nodes);\n        });\n    }\n\n    return nodes;\n}\n\nfunction genRandomId() {\n    let randomStr = Math.random().toString(36);\n    let offset = Math.floor(Math.random() * (randomStr.length - 3));\n    let id = randomStr.slice(offset, offset + 3);\n\n    return id;\n}\n\n// 获取剧情点的下一级子节点的id\nfunction getNextDialogIds(dialog) {\n    return (dialog.children || []).filter(id => (id !== '' && id !== '-1'));\n\n}\n\n/**\n* @desc 函数防抖---“立即执行版本” 和 “非立即执行版本” 的组合版本\n* @param func 需要执行的函数\n* @param wait 延迟执行时间（毫秒）\n* @param immediate---true 表立即执行，false 表非立即执行\n**/\nexport function debounce(func, wait, immediate) {\n    let timer;\n\n    return function () {\n        let context = this;\n        let args = arguments; \n\n        if (timer) clearTimeout(timer);\n        if (immediate) {\n            var callNow = !timer;\n            timer = setTimeout(() => {\n                timer = null;\n            }, wait)\n            if (callNow) func.apply(context, args)\n        } else {\n            timer = setTimeout(function () {\n                func.apply(context, args)\n            }, wait);\n        }\n    }\n}","/**\n * 剧情分支树图表\n */\n\nimport * as echarts from \"echarts/src/echarts\"\nimport \"echarts/src/chart/graph\"\n// 引入提示框组件、标题组件、工具箱组件。\nimport 'echarts/src/component/tooltip';\n// import 'echarts/src/component/title';\n// import 'echarts/src/component/toolbox';\nimport { filterDialogsByChapter, debounce } from \"./util\"\n\nexport default class STChart {\n    constructor(el) {\n        this.el = el\n        this.chart = null\n        this.currChapter = 0\n        this.processDialogs = null\n        this.clickHandler = null\n        this.mouseoutHandler = null\n        this.mouseoverHandler = null\n        this._defaultOpt = {\n            // title: {\n            //     text: '',\n            //     subtext: '',\n            //     top: 'bottom',\n            //     left: 'right'\n            // },\n            xAxis: {\n                type: 'value',\n                show: false,\n                min: 0,\n                max: 'dataMax',\n                splitLine: {\n                    show: true\n                },\n                value: [10, 20, 30, 40, 50, 60, 70, 80, 90, 100]\n                // position: \"bottom\"\n            },\n            yAxis: {\n                type: 'value',\n                show: false,\n                min: 0,\n                max: 'dataMax',\n                splitLine: {\n                    show: true\n                },\n                position: \"left\",\n                value: [-50, -40, -30, -20, -10, 0, 10, 20, 30, 40]\n            },\n            backgroundColor: 'rgba(210, 236, 252, 0.2)',\n            tooltip: {\n                // 鼠标悬浮展示内容\n                // confine: false,\n                // position: [10, 10],\n                position: function (pos, params, el, elRect, size) {\n                    var obj = { top: 10 };\n                    obj[['left', 'right'][+(pos[0] < size.viewSize[0] / 2)]] = 30;\n                    return obj;\n                },\n                formatter: function (data) {\n                    if (data.dataType == \"node\") {\n                        let sourceData = data.data.dataSet;\n                        let str = '';\n                        str = str + '【名称】' + sourceData.name + '<br />';\n                        str = str + `【章节】第${sourceData.chapter}章<br />`;\n                        str += `【剧情】 ${sourceData.description}`\n                        // if (sourceData.selectors.length > 1) {\n                        //     str = str + '【选项】' + '<br />';\n                        //     sourceData.selectors.forEach((item, index) => {\n                        //         str =\n                        //             str +\n                        //             '<span style=\"margin-left:1rem;color:#eaeaea\" >第' +\n                        //             (index + 1) +\n                        //             '项:' +\n                        //             item.keywordsArr.join(',') +\n                        //             '</p><br />';\n                        //     });\n                        // }\n                        return str;\n                    } else if (data.dataType == \"edge\") {\n                        return data.data.name;\n                    }\n                }\n            },\n            series: [\n                {\n                    type: 'graph',\n                    layout: 'none',\n                    // coordinateSystem: 'cartesian2d', //采用直角坐标系\n                    symbolSize: [40, 15],\n                    symbolOffset: [5, 0],\n                    roam: 'scale',\n                    label: {\n                        normal: {\n                            color: 'rgba(0, 0, 0, 0.6)',\n                            fontStyle: 'normal',\n                            show: true\n                        }\n                    },\n                    symbol: 'circle',\n                    edgeSymbol: ['circle', 'arrow'],\n                    edgeSymbolSize: [4, 10],\n                    // edgeLabel: {\n                    //     fontSize: 20\n                    // },\n                    data: [], // 挂载自定数据\n                    links: [], // 挂载箭头连线数据\n                    lineStyle: {\n                        normal: {\n                            opacity: 0.9,\n                            width: 2,\n                            curveness: 0\n                        }\n                    }\n                }\n            ],\n        }\n        this.treeConfig = {\n            xStartPosition: 10,\n            yPositionSize: 3,\n            xPositionSize: 5,\n            edge: {\n                style: ['none', 'arrow'],\n                size: [0, 2]\n            },\n            line: {\n                type: \"solid\",\n                opacity: 0.9,\n                width: 2,\n            },\n            lineDashed: {\n                type: \"dashed\",\n                opacity: 0.2,\n                width: 2,\n            },\n            guts: {\n                begin: {\n                    symbol:\n                        'path://M183.296,126.771c0,2.87-2.327,5.197-5.197,5.197H45.865c-2.87,0-5.197-2.327-5.197-5.197V79.545c0-2.87,2.327-5.197,5.197-5.197H178.1c2.87,0,5.197,2.327,5.197,5.197V126.771z',\n                    symbolSize: [50, 24],\n                    bgColor: 'rgba(243,46,0,0.5)',\n                    borderColor: 'rgba(243,46,0,1)',\n                    borderSize: '8px'\n                },\n                guts: {\n                    needSave: {\n                        symbol:\n                            'path://M183.296,126.771c0,2.87-2.327,5.197-5.197,5.197H45.865c-2.87,0-5.197-2.327-5.197-5.197V79.545c0-2.87,2.327-5.197,5.197-5.197H178.1c2.87,0,5.197,2.327,5.197,5.197V126.771z',\n                        symbolSize: [50, 24],\n                        bgColor: 'rgba(17,135,255,0.5)',\n                        borderColor: 'rgba(17,135,255,1)',\n                        borderSize: '8px'\n                    },\n                    nonSave: {\n                        symbol:\n                            'path://M183.296,126.771c0,2.87-2.327,5.197-5.197,5.197H45.865c-2.87,0-5.197-2.327-5.197-5.197V79.545c0-2.87,2.327-5.197,5.197-5.197H178.1c2.87,0,5.197,2.327,5.197,5.197V126.771z',\n                        symbolSize: [50, 24],\n                        bgColor: 'rgba(17,135,255,0.5)',\n                        borderSize: 0\n                    }\n                },\n                ending: {\n                    symbol:\n                        'path://M183.296,126.771c0,2.87-2.327,5.197-5.197,5.197H45.865c-2.87,0-5.197-2.327-5.197-5.197V79.545c0-2.87,2.327-5.197,5.197-5.197H178.1c2.87,0,5.197,2.327,5.197,5.197V126.771z',\n                    symbolSize: [50, 24],\n                    bgColor: 'rgba(250,173,20,0.5)',\n                    borderColor: 'rgba(250,173,20,0.1)',\n                    borderSize: '8px'\n                },\n                next: {\n                    symbol:\n                        'path://M183.296,126.771c0,2.87-2.327,5.197-5.197,5.197H45.865c-2.87,0-5.197-2.327-5.197-5.197V79.545c0-2.87,2.327-5.197,5.197-5.197H178.1c2.87,0,5.197,2.327,5.197,5.197V126.771z',\n                    symbolSize: [50, 24],\n                    bgColor: 'rgba(0,0,0,0.1)',\n                    borderColor: 'rgba(0,0,0,0.1)',\n                    borderSize: '8px'\n                }\n            },\n            dataZoom: [\n                {\n                    type: 'slider',\n                    show: false,\n                    xAxisIndex: [0],\n                    startValue: 0,\n                    endValue: 50,\n                    minValueSpan: 40,\n                    maxValueSpan: 200,\n                    showDetail: false,\n\n                    filterMode: 'weakFilter',\n                    height: 20,\n\n                    handleIcon:\n                        'M10.7,11.9H9.3c-4.9,0.3-8.8,4.4-8.8,9.4c0,5,3.9,9.1,8.8,9.4h1.3c4.9-0.3,8.8-4.4,8.8-9.4C19.5,16.3,15.6,12.2,10.7,11.9z M13.3,24.4H6.7V23h6.6V24.4z M13.3,19.6H6.7v-1.4h6.6V19.6z',\n                    handleSize: '80%'\n                },\n                {\n                    type: 'inside',\n                    show: false,\n\n                    zoomOnMouseWheel: 'shift',\n                    zoomLock: true,\n                    xAxisIndex: [0]\n                }\n            ]\n        }\n    }\n\n    static init(el) {\n        let instance = new STChart(el)\n        instance.setOption()\n        return instance\n    }\n\n    setOption(opt = {}) {\n        this._extend(this._defaultOpt, opt)\n        this.chart = echarts.init(this.el)\n        // if (this.processDialogs) this.renderStory()\n        // return this\n    }\n\n    setData(dialogs) {\n        if (this._typeof(dialogs) == \"Array\") {\n            this.processDialogs = dialogs\n            // this.setOption()\n            return this\n        } else {\n            throw new Error(\"dialos \"+dialogs+\" is not array!\")\n        }\n    }\n\n    prevChap() {\n        if (this.currChapter <= 1)  return\n        this.renderStory(--this.currChapter)\n    }\n\n    nextChap() {\n        this.renderStory(++this.currChapter)\n    }\n\n    registerListener(event, handler, self) {\n        if (this._typeof(handler) != \"Function\") {\n            throw new Error(`${handler} is required function`)\n        }\n        let args = Array.prototype.slice.call(arguments, 3)\n        \n        switch (event) {\n            case \"click\":\n                this.clickHandler = handler.bind(self, ...args)\n                break\n            case \"mouseout\":\n                this.mouseoutHandler = handler.bind(self, ...args)\n                break\n            case \"mouseover\":\n                this.mouseoverHandler = handler.bind(self, ...args)\n                break\n        }\n    }\n\n    /**\n     * 按章节显示剧情\n     * @param {Number} chapter \n     */\n    renderStory(chapter) {\n        this.currChapter = chapter || 0\n        let graphSeries = this._defaultOpt.series[0]\n\n        let chartData = filterDialogsByChapter(this.currChapter, this.processDialogs)\n        graphSeries.data = []\n        graphSeries.links = []\n        chartData.datas.forEach(data => {\n            let nodeData = {\n                id: data.id,\n                name: data.name,\n                itemStyle: {\n                    normal: {\n                        color: ''\n                    }\n                },\n                chapterNo: data.chapter ? data.chapter : '1',\n                isOfNextChap: this.currChapter !== 0 && this.currChapter !== data.chapter,\n                symbol: '',\n                symbolSize: [0, 0],\n                x: 0,\n                y: 0,\n                dataSet: data,\n                attributes: {\n                    modularity_class: ''\n                }\n            }\n            graphSeries.data.push(nodeData)\n        })\n        chartData.links.forEach(link => {\n            let targetNode = graphSeries.data.find(\n                d => d.id === link.target\n            );\n            let linkType = targetNode.isOfNextChap ? 'lineDashed' : 'line';\n\n            let linkData = {\n                id: link.id,\n                name: link.name,\n                source: link.source,\n                target: link.target,\n                lineStyle: this.treeConfig[linkType]\n            };\n            graphSeries.links.push(linkData)\n        })\n\n        console.warn(graphSeries)\n\n        this.chart.showLoading()\n        this._resizeGutNode()\n    }\n\n    _resizeGutNode() {\n        // 按照position排序\n        let graphSeries = this._defaultOpt.series[0]\n        graphSeries.data.sort(function (a, b) {\n            return a.dataSet.position - b.dataSet.position;\n        });\n        this.maxPosition =\n            graphSeries.data[\n                graphSeries.data.length - 1\n            ].dataSet.position;\n\n        this._repositionNodes();\n\n        this._showTree('rezoom');\n    }\n\n    _repositionNodes() {\n        let positonCount = new Map();\n        // 顺序调整结束\n\n        let maxCount = 0;\n\n        // 遍历每个列，计算每个position数目\n        this._defaultOpt.series[0].data.forEach(node => {\n            // 剧情点\n            if (positonCount.get(node.dataSet.position) > 0) {\n                positonCount.set(\n                    node.dataSet.position,\n                    positonCount.get(node.dataSet.position) + 1\n                );\n            } else {\n                positonCount.set(node.dataSet.position, 1);\n            }\n\n            if (positonCount.get(node.dataSet.position) > maxCount) {\n                maxCount = positonCount.get(node.dataSet.position);\n            }\n        });\n        // 计算每个position数目结束\n\n        // 开始重新计算Y值\n\n        let positonCount_Used = new Map();\n\n        this._defaultOpt.series[0].data.forEach((node) => {\n            // 剧情点\n            if (positonCount_Used.get(node.dataSet.position) > 0) {\n                positonCount_Used.set(\n                    node.dataSet.position,\n                    positonCount_Used.get(node.dataSet.position) + 1\n                );\n            } else {\n                positonCount_Used.set(node.dataSet.position, 1);\n            }\n\n            // var dz = parseInt(maxCount * 10 / (positonCount.get(node.dataSet.position)))\n            var dz = this.treeConfig.xPositionSize;\n\n            node.y =\n                ((positonCount.get(node.dataSet.position) + 1) * dz) / 2 -\n                dz * positonCount_Used.get(node.dataSet.position);\n\n            node.x = node.dataSet.position * this.treeConfig.xPositionSize + this.treeConfig.xStartPosition;\n            node.y = parseInt(node.y);\n            node.x = parseInt(node.x);\n        });\n    }\n\n    _showTree(rezoom) {\n        this.chart.showLoading();\n\n        this._defaultOpt.series[0].data.forEach((data) => {\n            data.value = [data.x, data.y];\n\n            // 设置节点样式\n            this._setGutsStyle(data);\n\n            // this.nodeMap.set(data.dataSet.id, data.dataSet);\n        });\n\n        // 调整dataZoom位置\n        if (!this._defaultOpt.dataZoom) this._defaultOpt.dataZoom = this.treeConfig.dataZoom;\n        // 如果节点少，那么隐藏底部滚动条\n        if (this.maxPosition * this.treeConfig.xPositionSize <= 50) {\n            this._defaultOpt.dataZoom[0].show = false;\n        } else {\n            this._defaultOpt.dataZoom[0].show = true;\n            let _defaultOpt = this.chart.getOption();\n            if (_defaultOpt) {\n                this._defaultOpt.dataZoom[0].startValue = _defaultOpt.dataZoom[0].startValue;\n                let endValue = this._defaultOpt.dataZoom[0].endValue = _defaultOpt.dataZoom[0].endValue;\n                if (endValue > 99) this._defaultOpt.dataZoom[0].endValue = this.maxPosition * this.treeConfig.xPositionSize + 10;\n            }\n        }\n\n        // 重置进度条\n        if (rezoom) {\n            this._defaultOpt.dataZoom[0].startValue = 0;\n            this._defaultOpt.dataZoom[0].endValue = 50;\n        }\n\n        // 调整X轴\n        // console.log(this.maxPosition);\n        this._defaultOpt.xAxis.max =\n            this.maxPosition * this.treeConfig.xPositionSize + 10;\n\n        this.chart.on('click', debounce((params) => {\n            this.clickHandler && this.clickHandler(params)\n        }, 200, true));\n\n        this.chart.on('mouseout', debounce((params) => {\n            this.mouseoutHandler && this.mouseoutHandler(params)\n        }, 200, true));\n\n        this.chart.on('mouseover', debounce((params) => {\n            this.mouseoverHandler && this.mouseoverHandler(params)\n        }, 200, true));\n\n        this.chart.hideLoading();\n        this.chart.setOption(this._defaultOpt);\n    }\n\n    // 设置节点样式\n    _setGutsStyle(nodeData) {\n        if (nodeData.isOfNextChap) {\n            nodeData.symbol = this.treeConfig.guts['next'].symbol;\n            nodeData.symbolSize = this.treeConfig.guts['next'].symbolSize;\n            nodeData.itemStyle.normal.color = this.treeConfig.guts['next'].bgColor;\n            nodeData.itemStyle.normal.cursor = 'not-allowed';\n            nodeData.itemStyle.normal.borderColor = this.treeConfig.guts[\n                'next'\n            ].borderColor;\n            nodeData.itemStyle.normal.borderSize = this.treeConfig.guts[\n                'next'\n            ].borderSize;\n            nodeData.itemStyle.normal.opacity = 0.4;\n            // nodeData.attributes.modularity_class = '衔接点';\n\n            return;\n        }\n\n        let data = nodeData.dataSet;\n\n        // ['开始', '剧情', '结局'],\n        if (data.nodeType == '开始') {\n            nodeData.symbol = this.treeConfig.guts['begin'].symbol;\n            nodeData.symbolSize = this.treeConfig.guts['begin'].symbolSize;\n            nodeData.itemStyle.normal.color = this.treeConfig.guts['begin'].bgColor;\n            nodeData.itemStyle.normal.borderColor = this.treeConfig.guts[\n                'begin'\n            ].borderColor;\n            nodeData.itemStyle.normal.borderSize = this.treeConfig.guts[\n                'begin'\n            ].borderSize;\n\n        } else if (data.nodeType == '剧情') {\n            nodeData.symbol = this.treeConfig.guts['guts'].nonSave.symbol;\n            nodeData.symbolSize = this.treeConfig.guts['guts'].nonSave.symbolSize;\n            nodeData.itemStyle.normal.color = this.treeConfig.guts[\n                'guts'\n            ].nonSave.bgColor;\n            nodeData.itemStyle.normal.borderSize = this.treeConfig.guts[\n                'guts'\n            ].nonSave.borderSize;\n            // nodeData.attributes.modularity_class = '剧情';\n        } else if (data.nodeType == '结局') {\n            nodeData.symbol = this.treeConfig.guts['ending'].symbol;\n            nodeData.symbolSize = this.treeConfig.guts['ending'].symbolSize;\n            nodeData.itemStyle.normal.color = this.treeConfig.guts[\n                'ending'\n            ].bgColor;\n            nodeData.itemStyle.normal.borderColor = this.treeConfig.guts[\n                'ending'\n            ].borderColor;\n            nodeData.itemStyle.normal.borderSize = this.treeConfig.guts[\n                'ending'\n            ].borderSize;\n        } \n\n\n        return nodeData;\n    }\n\n    _extend(target, obj) {\n        Object.keys(obj).forEach(key => {\n            if (_typeof(obj[key]) == \"object\") {\n                if (target[key])\n                    this._extend(target[key], obj[key])\n            } else {\n                target[key] = obj[key]\n            }\n        })\n        return target\n    }\n\n    _typeof(o) {\n        return Object.prototype.toString.call(o).slice(8, -1)\n    }\n}\n"],"names":["NODE_TYPE_TEXT","filterDialogsByChapter","chapter","processDialogs","dialogs","dialogsInNextChap","filter","d","getDialogsOfNextChapter","f_data","formatData","datas","dioDatas","nodes","links","length","_genDefaultData","posMap","genDialogPosition","dialogTreeDatas","genDialogTree","forEach","value","children","temp","_genLinks","node","_genNodes","push","nextDialogId","index","findIndex","item","dialogId","id","name","source","target","dialog","treeNode","find","n","isChapFirstNode","deepLevel","parents","some","description","position","nodeType","type","startId","genRandomId","nextId","currChapNo","roots","findRoots","root","_genPos","nextIds","getNextDialogIds","child","undefined","_findRoots$1","includes","_findRoots$2","nextDialog","map","currChapDialog","roots$1","roots$2","Set","concat","idInCurrChap","result","ids","_gen","parent","preNode","handledNode","isExist","p","dialogsOnCricle","randomStr","Math","random","toString","offset","floor","slice","debounce","func","wait","immediate","timer","context","args","arguments","clearTimeout","callNow","setTimeout","apply","STChart","constructor","el","chart","currChapter","clickHandler","mouseoutHandler","mouseoverHandler","_defaultOpt","xAxis","show","min","max","splitLine","yAxis","backgroundColor","tooltip","pos","params","elRect","size","obj","top","viewSize","formatter","data","dataType","sourceData","dataSet","str","series","layout","symbolSize","symbolOffset","roam","label","normal","color","fontStyle","symbol","edgeSymbol","edgeSymbolSize","lineStyle","opacity","width","curveness","treeConfig","xStartPosition","yPositionSize","xPositionSize","edge","style","line","lineDashed","guts","begin","bgColor","borderColor","borderSize","needSave","nonSave","ending","next","dataZoom","xAxisIndex","startValue","endValue","minValueSpan","maxValueSpan","showDetail","filterMode","height","handleIcon","handleSize","zoomOnMouseWheel","zoomLock","init","instance","setOption","opt","_extend","echarts","setData","_typeof","Error","prevChap","renderStory","nextChap","registerListener","event","handler","self","Array","prototype","call","bind","graphSeries","chartData","nodeData","itemStyle","chapterNo","isOfNextChap","x","y","attributes","modularity_class","link","targetNode","linkType","linkData","console","warn","showLoading","_resizeGutNode","sort","a","b","maxPosition","_repositionNodes","_showTree","positonCount","Map","maxCount","get","set","positonCount_Used","dz","parseInt","rezoom","_setGutsStyle","getOption","on","hideLoading","cursor","Object","keys","key","o"],"mappings":"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"}